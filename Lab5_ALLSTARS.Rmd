---
title: "Lab 5 TEAM: ALL STARS"
author: "Johnny Tamanaha, Emily Archambault, Eugene Miller, Kaiyuan Fan, Jingzhi Zhang"
date: "9/29/2019"
output: html_document
---
```{r, setup, echo = FALSE, message = FALSE}
library(tidyverse)
milk <- read.csv('state_milk_production.csv')

milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)
```

The year when the most milk was produced in the United States:
```{r, echo = FALSE}
year_most_produced <- milk %>%
  group_by(year) %>%
  summarize(total_prod=sum(milk_millions)) %>%
  filter(rank(desc(total_prod)) < 2)
year_most_produced
```


The year when the least milk was produced in the United States:
```{r, echo = FALSE}

```


In 2017, the 5 states that produced the most milk:
```{r, echo = FALSE, message = FALSE, error = FALSE, warning = FALSE}
milk2017 <- milk %>%
  filter(year == 2017)

top5_2017 <- milk2017 %>%
  arrange(desc(milk_produced)) %>%
  top_n(5) %>%
  as.tibble()
print(top5_2017, max_levels = NULL, width = 5000)
```


In 2017, the 5 states that produced the least milk:
```{r, echo = FALSE}

```



### Plots For States We Have Lived In

### California
```{r, echo = FALSE, message = FALSE}
milkCA <- milk %>%
  filter(state == 'California')

milksum <- milk %>%
  group_by(year) %>%
  summarize('Milk produced in year:' , sum(milk_million))
milkyears <- data.frame(milksum)
  
ggplot() +
  geom_point(data = milkCA, mapping = aes(x = year, y = milk_million)) + 
  geom_smooth(data = milkyears, mapping = aes(x = year, y = sum.milk_million.), se = FALSE) +
  labs(x = "Year", y = "Milk Produced (In Millions of Gallons)", title = "Milk Produced in CA and Entire USA Between 1970 and 2017")
```


### Individual Sections